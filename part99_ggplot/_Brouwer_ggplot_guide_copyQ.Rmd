---
title: "Intro to Plotting in R"
author: "brouwern@gmail.com"
date: "July 2017"
output: html_document
---

*Things to cover*
boxplot - base, qplot, ggplot
boxplot ordered
histogram 
scatterplot
scatterplot w/vert/hort/1:1
scatterplot with regression lines
scatterplot with spline smoother

scatterplot matrix


## Reference

Martin, TE.  1995.  Avian Life History Evolution in Relation to Nest Sites, Nest Predation, and Food.  Ecological Monographs.
http://onlinelibrary.wiley.com/doi/10.2307/2937160/full

**Abstract:**
"Food limitation is generally thought to underlie much of the variation in life history traits of birds. I examined variation and covariation of life history traits of 123 North American Passeriformes and Piciformes in relation to nest sites, nest predation, and foraging sites to examine the possible roles of these ecological factors in life history evolution of birds. Annual fecundity was strongly inversely related to adult survival, even when phylogenetic effects were controlled. Only a little of the variation in fecundity and survival was related to foraging sites, whereas these traits varied strongly among nest sites. Interspecific differences in nest predation were correlated with much of the variation in life history traits among nest sites, although energy trade—offs with covarying traits also may account for some variation. For example, increased nest predation is associated with a shortened nestling period and both are associated with more broods per year, but number of broods is inversely correlated with clutch size, possibly due to an energy trade—off. Number of broods was much more strongly correlated with annual fecundity and adult survival among species than was clutch size, suggesting that clutch size may not be the primary fecundity trait on which selection is acting. Ultimately, food limitation may cause trade—offs between annual fecundity and adult survival, but differences among species in fecundity and adult survival may not be explained by differences in food abundance and instead represent differing tactics for partitioning similar levels of food limitation. Variation in fecundity and adult survival is more clearly organized by nest sites and more closely correlated with nest predation; species that use nest sites with greater nest predation have shorter nestling periods and more broods,yielding higher fecundity, which in turn is associated with reduced adult survival. Fecundity also varied with migratory tendencies; short—distance migrants had more broods and greater fecundity than did neotropical migrants and residents using similar nest sites. However, migratory tendencies and habitat use were confounded, making separation of these two effects difficult. Nonetheless, the conventional view that neotropical migrants have fewer broods than residents was not supported when nest site effects were controlled."


#### Load Martin 1995 data
```{r}
martin <- read.csv("martin_1995_avian_life_history_evolution_appendix1_CSV.csv", skip = 1,
                  na.strings = c("NA","na") )
```


Change the "non-excavating" group to "secondary cavity"
```{r}
martin$group <- gsub("non-excavating","2ndary cav.",martin$group)

```


Change the "group-nesting" group to "ground"
```{r}

martin$group <- gsub("ground-nesting","ground",martin$group)
```



#Make some more changes to shorten the group names

```{r}
martin$group <- gsub("Subcanopy or canopy","subcan-/canopy",martin$group)

martin$group <- gsub("shrub or low foliage","shrub",martin$group)

martin$group <- gsub("excavating","excav",martin$group)
```



Classify general lattitudinal region as tropical, boreal, or temperate
```{r}
martin$trop.or.temp <- "temperate"
i.tropics <- which(martin$lat < 23)
i.boreal <- which(martin$lat > 54)

martin$trop.or.temp[i.tropics] <- "tropics"
martin$trop.or.temp[i.boreal] <- "boreal"
```

write.csv(martin, file = "martin_edit_CSV.csv")


Change name of martin dataframe to data
```{r}
data <- martin
```









### How do I put two plots next to each other using ggplot?
Oneliner
library(ggplot2)
qplot(y = pred, x = nest.dur, data = data)


### How do I add a regression line to a scatterplot with ggplot?
Oneliner
library(ggplot2)
qplot(y = pred, x = nest.dur, data = data,
geom = c("smooth","point"), method = "lm")


Skelp
qplot(y = pred, x = nest.dur, data = data,
geom = c("smooth","point"),
se = FALSE,
method = "lm",
xlab = "xlab = nesting duration",
ylab = "ylab = predation rate",
main = "main title: predation vs. nesting duration")





## GGPLOT
library(ggplot2)

### Increase the font size for the x and y axes in ggplot?

### How do I increae the SIZE OF THE TICK LABELS on the x and y axes?
### How do I increase the size of TITLES or labels on the x and y axes?
### How do I make these things bold?
Use "theme(axis.text = element_text(size = ...))" for the axis labels.
Use "theme(axis.tile = element"

```{r}
qplot(clutch.sz,
       data = data) + 
  geom_vline(xintercept = 5) +
  xlab("Clutch size") +
  ylab("Count") + 
  ggtitle("Distribution of clutch sizes, data 1992") +
  theme(axis.text=element_text(size=18),               #increase  font size to 18
        axis.title=element_text(size=22,
                                face="bold")) #use bold text
```




### How do I add horizontal and vertical lines to a ggplot?
geom_hline(xintercept = 0)
geom_vline(yintercept = 0)



### How do I flip or rotate the coordinates to that the y-axis becomes the x-axis in ggplot? 


```{r}
coord_flip()
```
This can be used to make coefficient plots and forests plots.


### How do I flip the y axis so that positive values are on the opposite side in ggplot?
scale_y_reverse()


### How do I manually set the colors for the legend or scale in ggplot?
### How do I change  the colors of the legend or scale in ggplot?

scale_colour_manual(name="Experimental\nSettings",
                      values=colors_BeS.3,
                      labels=c("Greenhouse", "Greenhouse\n& Field")) 







### How do I make a confidence band around a line in ggplot?
#(regression, linear model, CI, confidence interval)
geom_ribbon(aes(ymin=SE.real.minus,
                             ymax=SE.real.plus),
                         alpha=0.15,
                         linetype = 0)



### How do i set the limits on the x or y axis in ggplot?
### How do I re-name the x or y axis in ggplot?
The commands scale_x_continous() and scale_y_continous() can do several things.  See also xlab() and ylab()
```{r}
scale_x_continuous(name="Stem Length",limits=c(15,100)) + #Stem Length (cm)
scale_y_continuous(name="Reversion Probability")
```



### How do I make changes to the legend in ggplot?
### How do I change the position of the legend in ggplot?
### How do I change the title over the legend?
### How do I change the font of the *title* of the  legend in ggplot?
### How do I change the font of the *labels* of the legend in ggplot?


```{r}
#keywords: ggplot, legend, font, bold,
theme(
  legend.position="right",
  #legend.position=c(0.15, .85),
  legend.title = element_text(colour="black", 
                              size=24, 
                              face="bold"),
  legend.text = element_text(colour="black", 
                             size = 20, 
                             face = "bold")) +
  
```


                             
                          
                          
                          
### How do I change the thickness of the axes in ggplot?                      
```{r}
theme(axis.line = element_line(size=2, color = "black"))    #makes axes lines thicker
```


### How do I get rid of/remove/suppress the box around the plotting field
```{r}
# keywords: box, border, edging, around blot
 theme(panel.border = element_rect(color = "white")) 
```


#### How do I get rid of the box around...
```{r}
# keywords: box, border, edging, around blot
theme(legend.key = element_rect(colour = 'white')) +   # gets rid of box around length key items

```


#### How do I get rid of the grid lines within the plot in ggplot?
```{r}
 theme(panel.grid.minor=element_blank(), 
       panel.grid.major=element_blank())
```


#### How do I set the font of the axes titles?
#### How do I adjust the positions of the axes titles?
```{r}
theme(axis.title.x = element_text(face="bold", size=32),
      axis.text.x  = element_text(vjust=0.95, 
      size=32,
      face="bold"),
      axis.title.y = element_text(face="bold", 
              size=32,
            vjust=0.35),
              axis.text.y  = element_text(vjust=0.5, 
              size=32,face="bold"))

```



#### How do I drop, remove or suppress the legend in ggplot?
theme(legend.position = "none")


#### Remove facet strip completely
http://stackoverflow.com/questions/10547487/r-removing-facet-wrap-labels-completely-in-ggplot2
 
theme(strip.background = element_blank(),
       strip.text.x = element_blank())



#### How do I increase the size text of the within facets?
#### How do I increase the font size of facet labels?
http://stackoverflow.com/questions/2751065/how-can-i-manipulate-the-strip-text-of-facet-plots-in-ggplot2/2751201#2751201
theme(strip.text.x = element_text(size = 8, colour = "orange", angle = 90))




#### How do I reorder a factor variable for plotting in ggplot?
levs <- mult.comp.df$names.ordered[order.x]
mult.comp.df$names.ordered <- factor(mult.comp.df$names.ordered,
                                     levels = levs)






#### colorblind palletes
color blind palletes
http://dr-k-lo.blogspot.com/2013/07/a-color-blind-friendly-palette-for-r.html
http://www.cookbook-r.com/Graphs/Colors_%28ggplot2%29/








#mult.comp.df$names <- with(mult.comp.df, reorder(names, coefficients, function(x) -order(x)))





Plot clutch size versus duration of incubation using basic R plotting function
```{r}
plot(surv.adult ~ clutch.sz, data = data)
```


Plot distribution of survival rates
```{r}
hist(data$surv.adult)
```

Plot distribution of clutch sizes
```{r}
hist(data$clutch.sz)
```


Load ggplot package
```{r}
library(ggplot2)
```

Plot distribution of clutch sizes in ggplot
```{r}
qplot(clutch.sz,
       data = data)
```



Add line at 6 for LOWA
```{r}
qplot(clutch.sz,
       data = data) + geom_vline(xintercept = 5)
```



Add labels
```{r}
qplot(clutch.sz,
       data = data) + 
  geom_vline(xintercept = 5) +
  xlab("Clutch size") +
  ylab("Count") +
  ggtitle("Distribution of clutch sizes, data 1992")
```




Make background white
```{r}
qplot(clutch.sz,
       data = data) + 
  geom_vline(xintercept = 5) +
  xlab("Clutch size") +
  ylab("Count") +
  ggtitle("Distribution of clutch sizes, data 1992") +
  theme(axis.text=element_text(size=18),
        axis.title=element_text(size=22,face="bold")) + 
  theme_bw()
```





Plot as density curve
```{r}
qplot(clutch.sz,
       data = data,
      geom = "density") + 
  geom_vline(xintercept = 6) +
  xlab("Clutch size") +
  ylab("Count") +
  ggtitle("Distribution of clutch sizes, data 1992") +
  theme(axis.text=element_text(size=18),
        axis.title=element_text(size=22,face="bold")) + 
  theme_bw()
```




Plot as separate density curve for each nest type group
```{r}
qplot(clutch.sz,
       data = data,
      geom = "density",
      color = group,
      group = group) + 
  geom_vline(xintercept = 6) +
  xlab("Clutch size") +
  ylab("Count") +
  ggtitle("Distribution of clutch sizes, data 1992") +
  theme(axis.text=element_text(size=18),
        axis.title=element_text(size=22,face="bold")) + 
  theme_bw()
```








Plot distribution of clutch sizes by FORAGING site
```{r}
qplot(clutch.sz,
       data = data,
      facets = . ~ foraging.site)
```



Use facet wrap
```{r}
qplot(clutch.sz,
       data = data) +
  facet_wrap(~foraging.site)
```





Plot distribution of clutch sizes by habitat group
```{r}
qplot(clutch.sz,
       data = data,
      facets = . ~ group)
```


Boxplot
```{r}
qplot(y = clutch.sz,
      x = group,
      geom = "boxplot",
       data = data) +
  geom_hline(yintercept = 6)
```



Incubation period vs. predation
```{r}
qplot(y = inc.dur,
      x = pred,
      data = data)
```






Plot adult survival versus duration of incubation in ggplot
```{r}
qplot(y = surv.adult,
      x = clutch.sz,
      data = data)
```









Plot adult survival  versus duration of incubation in ggplot
```{r}
qplot(y = surv.adult,
      x = inc.dur,
      data = data)
```


Add a trend line
```{r}
qplot(y = surv.adult,
      x = clutch.sz,
      data = data,
      geom = c("point","smooth"))
```



Color code each group
```{r}
qplot(y = surv.adult,
      x = clutch.sz,
      data = data,
      color = group)
```


Make size of points bigger
```{r}
qplot(y = surv.adult,
      x = clutch.sz,
      data = data,
      color = group,
      size = 4)
```



Add trend line to each group
```{r}
qplot(y = surv.adult,
      x = clutch.sz,
      data = data,
      color = group,
      geom = c("point","smooth"),
      method = "lm",
      se = FALSE,
      size = 4)
```









Figure out which species have "warbler" in their name
data$warbler <- "not warbler"
data$warbler[grep("Warb", data$spp)] <- "warbler"

```{r}
qplot(y = clutch.sz,
      x = data$warbler,
      geom = c("boxplot","point"),
      data = data) + geom_hline(yintercept = 5)
```






##  save ggplot
```{r}
ggsave(...)
```






